<!DOCTYPE html>
<html>
<head>
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Love Memory Game ‚ù§Ô∏è</title>

<style>
body{
margin:0;
font-family:Segoe UI;
background:linear-gradient(135deg,#ff4f8b,#3b0030);
min-height:100vh;
display:flex;
flex-direction:column;
align-items:center;
color:white;
}

h2{margin-top:10px}

.grid{
display:grid;
grid-template-columns:repeat(4,70px);
gap:10px;
margin-top:15px;
}

.card{
width:70px;height:90px;
background:#ffd1dc;
border-radius:10px;
display:flex;
align-items:center;
justify-content:center;
font-size:30px;
cursor:pointer;
}

.hidden{background:#fff;}

#score,#best{margin-top:6px}

button{
margin-top:10px;
padding:8px 20px;
border-radius:20px;
border:none;
background:#ffd1dc;
}

.heart{
position:fixed;
font-size:20px;
animation:fly 2s linear;
}

@keyframes fly{
to{transform:translateY(-200px);opacity:0;}
}

#leader{
margin-top:10px;
font-size:12px;
max-width:220px;
}
</style>
</head>

<body>

<h2>‚ù§Ô∏è Love Memory Game</h2>

<div id="player"></div>
<div id="score">Score: 0</div>
<div id="best"></div>

<button onclick="restart()">Restart üîÑ</button>

<div class="grid" id="grid"></div>

<div id="leader"></div>

<audio id="match" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_3b1a0efdf3.mp3"></audio>

<script>

if(!localStorage.getItem("user")){
location.href="login.html";
}

player.innerHTML="Player: "+localStorage.getItem("user");

const emojis=["üíñ","üíç","üåπ","üòò","‚ù§Ô∏è","üòç"];
let cards=[];
let first=null,lock=false,score=0;

function start(){
grid.innerHTML="";
cards=[...emojis,...emojis].sort(()=>0.5-Math.random());
score=0;
scoreDiv();

cards.forEach(e=>{
let d=document.createElement("div");
d.className="card hidden";
d.dataset.val=e;
d.onclick=()=>flip(d);
grid.appendChild(d);
});
}

start();

/* flip */
function flip(c){
if(lock||!c.classList.contains("hidden"))return;

c.classList.remove("hidden");
c.innerHTML=c.dataset.val;

if(!first){first=c;return;}

if(first.dataset.val==c.dataset.val){
score++;
match.play();
saveBest();
burst();
first=null;
scoreDiv();
}else{
lock=true;
setTimeout(()=>{
first.innerHTML="";
c.innerHTML="";
first.classList.add("hidden");
c.classList.add("hidden");
first=null;
lock=false;
},700);
}
}

/* score */
function scoreDiv(){
score.innerHTML="Score: "+score;
}

/* hearts */
function burst(){
for(let i=0;i<10;i++){
let h=document.createElement("div");
h.className="heart";
h.innerHTML="üíñ";
h.style.left=Math.random()*100+"%";
h.style.bottom="0";
document.body.appendChild(h);
setTimeout(()=>h.remove(),2000);
}
}

/* restart */
function restart(){
start();
}

/* best score */
function saveBest(){
let b=localStorage.getItem("best")||0;
if(score>b){
localStorage.setItem("best",score);
}
best.innerHTML="Best: "+localStorage.getItem("best");
}

/* leaderboard */
function updateLeader(){
let arr=JSON.parse(localStorage.getItem("leader")||"[]");
arr.push({n:localStorage.getItem("user"),s:score});
arr.sort((a,b)=>b.s-a.s);
arr=arr.slice(0,5);
localStorage.setItem("leader",JSON.stringify(arr));

leader.innerHTML="<b>üèÜ Leaderboard</b><br>"+arr.map(x=>x.n+" : "+x.s).join("<br>");
}

window.onbeforeunload=updateLeader;

best.innerHTML="Best: "+(localStorage.getItem("best")||0);
updateLeader();

</script>

</body>
</html>
