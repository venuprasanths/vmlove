<!DOCTYPE html>
<html>
<head>
<title>Love Message Wall üíå</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{
margin:0;
font-family:Segoe UI,Arial;
background:linear-gradient(135deg,#ff4f8b,#3b0030);
min-height:100vh;
color:white;
padding:15px;
}

h2{text-align:center;}

.card{
background:rgba(255,255,255,.2);
padding:15px;
border-radius:20px;
max-width:400px;
margin:auto;
}

input,textarea{
width:100%;
padding:8px;
border-radius:10px;
border:none;
margin-top:8px;
}

button{
margin-top:10px;
width:100%;
padding:10px;
border-radius:15px;
border:none;
background:#ffd1dc;
cursor:pointer;
}

.msg{
background:white;
color:black;
padding:8px;
border-radius:10px;
margin:6px 0;
font-size:13px;
}

.time{font-size:10px;color:gray;}

.del{float:right;color:red;cursor:pointer;}

.actions{
display:flex;
gap:10px;
margin-top:5px;
font-size:12px;
}

.actions span{cursor:pointer;}

.avatar{
width:35px;
height:35px;
border-radius:50%;
object-fit:cover;
float:left;
margin-right:8px;
}

/* celebration */
.confetti{
position:fixed;
top:-10px;
font-size:22px;
animation:fall 2s linear forwards;
}
@keyframes fall{to{transform:translateY(110vh) rotate(360deg);opacity:0;}}

</style>
</head>

<body>

<h2>üíå Love Wall</h2>

<div class="card">

<input id="uname" placeholder="Your name">
<input type="file" id="pic">
<textarea id="umsg" placeholder="Write message"></textarea>

<button onclick="sendMsg()">Send ‚ù§Ô∏è</button>

<input id="pin" placeholder="Admin PIN (1234)">

<div id="messages"></div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-app.js";
import { getDatabase, ref, push, onValue, remove, update } from "https://www.gstatic.com/firebasejs/12.8.0/firebase-database.js";

const firebaseConfig={
apiKey:"AIzaSyAetysNyLP1kFZIWM-IhDtHH_Kq7HoSGxg",
authDomain:"vmlove-a2df1.firebaseapp.com",
databaseURL:"https://vmlove-a2df1-default-rtdb.asia-southeast1.firebasedatabase.app",
projectId:"vmlove-a2df1",
storageBucket:"vmlove-a2df1.firebasestorage.app",
messagingSenderId:"932908158778",
appId:"1:932908158778:web:eb8185babb63b8aff80a03"
};

const app=initializeApp(firebaseConfig);
const db=getDatabase(app);
const wallRef=ref(db,"wall");

/* send */
window.sendMsg=function(){
let n=uname.value.trim();
let m=umsg.value.trim();
if(!n||!m)return alert("Fill both");

let reader=new FileReader();
reader.onload=()=>{
push(wallRef,{
name:n,
msg:m,
time:new Date().toLocaleString(),
pic:reader.result||"",
likes:0
});
};
if(pic.files[0]) reader.readAsDataURL(pic.files[0]);
else reader.onload();

umsg.value="";
celebrate();
}

/* realtime show */
onValue(wallRef,(snap)=>{
messages.innerHTML="";
snap.forEach(s=>{
let d=s.val();
let id=s.key;

messages.innerHTML=
`<div class="msg" id="${id}">
<img src="${d.pic}" class="avatar">
<b>${d.name}</b>
<span class="del" onclick="delMsg('${id}')">üóë</span><br>
${d.msg}<br>
<span class="time">${d.time}</span>

<div class="actions">
<span onclick="likeMsg('${id}',${d.likes||0})">‚ù§Ô∏è ${d.likes||0}</span>
<span onclick="waShare('${d.name}','${d.msg}')">üì≤ Share</span>
</div>

</div>`+messages.innerHTML;
});
});

/* like */
window.likeMsg=function(id,c){
update(ref(db,"wall/"+id),{likes:c+1});
}

/* whatsapp */
window.waShare=function(n,m){
window.open("https://wa.me/?text="+encodeURIComponent(n+": "+m));
}

/* delete admin */
window.delMsg=function(id){
if(pin.value=="1234"){
remove(ref(db,"wall/"+id));
}else alert("Admin only");
}

/* celebration */
function celebrate(){
for(let i=0;i<25;i++){
 let c=document.createElement("div");
 c.className="confetti";
 c.innerHTML="üíñ";
 c.style.left=Math.random()*100+"%";
 document.body.appendChild(c);
 setTimeout(()=>c.remove(),2000);
}
}

</script>

</body>
</html>
